<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>XTEA &mdash; Metin2Dev Wiki</title>
      <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/sphinx_highlight.js"></script>
        <script src="../../../../_static/design-tabs.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html">
            
              <img src="https://raw.githubusercontent.com/Metin2-Dev/Assets/main/128_round_black.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Wiki</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Topics/index.html">Topics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../Topics/Cryptography/index.html">Cryptography</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../Topics/Cryptography/index.html#algorythm-types">Algorythm Types</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../Topics/Cryptography/type_0.html">Raw (Type 0)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../Topics/Cryptography/type_1.html">-LZO (Type 1)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../Topics/Cryptography/type_2.html">~XTEA(-LZO) (Type 2)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../Topics/Cryptography/type_3.html">Panama (Type 3)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../Topics/Cryptography/type_4.html">HybridCrypt (Type 4)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../Topics/Cryptography/type_5.html">HybridCrypt SDB (Type 5)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../Topics/Cryptography/type_6.html">~XTEA(-Snappy) (Type 6)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../Topics/Formats/index.html">Formats</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../Topics/Networking/index.html">Networking</a><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Incomplete Topics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Formats/index.html">Formats</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Formats/texture_caching.html">DDS Texture Caching</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Formats/texture_caching.html#usage">Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Formats/texture_caching.html#rdch-format">RDCH Format</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../About/Contributing/index.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../About/Changelogs/index.html">Changelogs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../About/Maintenance/index.html">Maintenance</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../About/Maintenance/workflow.html">Workflow</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../About/Maintenance/workflow.html#o-development-flow">1º - Development flow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../About/Maintenance/workflow.html#o-beta-flow">2º - Beta flow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../About/Maintenance/workflow.html#o-stable-release-flow">3º - Stable release flow</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Wiki</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">XTEA</li>


      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/Metin2-Dev/Wiki/blob/main/pages/Incomplete/Networking/Encryption/XTEA.md" class="fa fa-github"> Edit on GitHub</a>
      </li>

<style>
	.edit-guidelines {
		font-size: 14px;
		float: right;
		clear: both;
	}

	@media screen and (max-width: 480px) {
		.edit-guidelines {
			display: none;
		}
	}
</style>
<a class="edit-guidelines" href="">
	Check out how to contribute!
</a>


  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="xtea">
<h1>XTEA<a class="headerlink" href="#xtea" title="Permalink to this heading">¶</a></h1>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this heading">¶</a></h2>
<section id="xtea-encryption">
<h3>XTEA Encryption<a class="headerlink" href="#xtea-encryption" title="Permalink to this heading">¶</a></h3>
<p>This encryption is divided in two phases, Auth Phase and Game Phase.</p>
<p>Every packet that uses this encryption gets encrypted and decrypted with the
TEA algorithm and a TEA key.</p>
<p>The encryption works by having two XTEA keys, the first one
(Referred as Auth phase key) is a static 16 bytes key used in the first stage
of the communication, this key will be used until a Client has attempted to log
in into a Channel (any core that is not an Auth one) with the login key method.</p>
<p>Once the client sends a Login packet to a channel, it will also send it’s
encryptation keys where the server’s encryptation keys will be computed.
The keys will be changed IMMEDIATLY, no extra packet or data is needed to
change the keys.</p>
<p>This generated second keys are referred as Game phase keys.</p>
<p>The client computes it’s decryptation key (likewise, the server computes it’s
encryptation key) by performing an XTEA of the encryptation key
(decryptation key for the server) with a Special key.</p>
<p>Key list</p>
<section id="auth-phase-keys">
<h4>Auth Phase keys<a class="headerlink" href="#auth-phase-keys" title="Permalink to this heading">¶</a></h4>
<p>Auth phase keys (Both for encrypting and decrypting) Usage 	First number 	Second number 	Notes</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Region</p></th>
<th class="head"><p>Key 1</p></th>
<th class="head"><p>Key 2</p></th>
<th class="head"><p>ASCII Representation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Worldwide</p></td>
<td><p>0x7473657474736574</p></td>
<td><p>0x7473657474736574</p></td>
<td><p>testtesttesttest</p></td>
</tr>
<tr class="row-odd"><td><p>European servers</p></td>
<td><p>0x6867666538373635</p></td>
<td><p>0x6463626134333231</p></td>
<td><p>1234abcd5678efgh</p></td>
</tr>
</tbody>
</table>
</section>
<section id="special-keys">
<h4>Special keys<a class="headerlink" href="#special-keys" title="Permalink to this heading">¶</a></h4>
<p>The Special key was generated by the Client and the Server during
the login into the Game core, it is known that in very old version of M2
(such as the Korean 2003 beta)
the following hardcoded key might be used rather than a random generated one.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Special keys Usage</p></th>
<th class="head"><p>First number</p></th>
<th class="head"><p>Second number</p></th>
<th class="head"><p>ASCII Representation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Korean server</p></td>
<td><p>0x6a6c48747854794a</p></td>
<td><p>0x726f484a566c4a48</p></td>
<td><p>JyTxtHljHJlVJHor</p></td>
</tr>
</tbody>
</table>
</section>
</section>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019-2023.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>